
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Figab Capital Partners</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/portfolio.css') }}">
<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/dist/date-fns.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>

<div class="accent-bar"></div>

<!-- ══════════════════════════════════════
     NAVIGATION
══════════════════════════════════════ -->
<header>
  <div class="header-inner">
    <div class="logo-block">
      <div class="logo-mark">
        <span class="logo-mark-letters">FCP</span>
      </div>
      <div class="logo-wordmark">
        <span class="logo-name">Figab Capital Partners</span>
      </div>
    </div>
    <nav id="menu">
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/reports">Reports</a></li>
      </ul>
    </nav>
    <div class="header-status">
    </div>
  </div>
</header>

<!-- ══════════════════════════════════════
     HERO
══════════════════════════════════════ -->
<section class="hero">
  <div class="hero-ring-inner"></div>

  <div class="hero-content">
    <div class="hero-mark">
      <span class="hero-mark-letters">FCP</span>
    </div>


    <div class="hero-name">Figab Capital Partners</div>

    <div class="hero-rule"></div>

    <div class="hero-tagline">
      Generating <em>alpha</em> since 2025.
    </div>

    <div class="hero-tagline-sub">Est. 2025 · Göteborg</div>

    <a href="#performance" class="hero-scroll-btn">
      <span class="hero-scroll-label">Portfolio</span>
      <div class="hero-scroll-chevron">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M2 4l4 4 4-4"/>
        </svg>
      </div>
    </a>
  </div>

  <span class="hero-est">Est. 2025</span>
  <span class="hero-location">Göteborg · Sweden</span>
</section>

<!-- ══════════════════════════════════════
     PERFORMANCE
══════════════════════════════════════ -->
<div id="performance">

  <div class="section-divider">
    <span class="section-divider-label">Portfolio Performance</span>
    <div class="section-divider-line"></div>
  </div>

  <!-- Metrics Bar -->
  <div class="metrics-bar">
    <div class="metric-cell">
      <div class="m-key">Portfolio Value</div>
      <div class="m-val">{{ "{:,.0f}".format(latest_value) }}<span class="currency">SEK</span></div>
      <div class="m-sub">Total market value</div>
    </div>
    <div class="metric-cell">
      <div class="m-key">Cash Position</div>
      <div class="m-val">{{ "{:,.0f}".format(cash) }}<span class="currency">SEK</span></div>
      <div class="m-sub">Available liquidity</div>
    </div>
    <div class="metric-cell">
      <div class="m-key">Active Holdings</div>
      <div class="m-val">{{ current | length }}</div>
      <div class="m-sub">Maximum 8 per bylaws</div>
    </div>
    <div class="metric-cell">
      <div class="m-key">Fund Inception</div>
      <div class="m-val" style="font-size:1.3rem; letter-spacing:0;">17 Feb 2025</div>
      <div class="m-sub">Operational</div>
    </div>
  </div>

  <!-- PCT Strip -->
  <div class="pct-strip">
    {% for key, value in pct_changes.items() %}
    <div class="pct-cell">
      <span class="p-label">{{ key }}</span>
      <span class="p-val {% if value is not none and value >= 0 %}positive{% else %}negative{% endif %}">
        {% if value is not none %}
          {{ "%+.2f"|format(value) }}%
        {% else %}N/A{% endif %}
      </span>
    </div>
    {% endfor %}
  </div>

  <!-- Chart -->
  <div class="chart-section">
    <div class="chart-top-bar">
      <div class="chart-label">
        <h3>Portfolio Development</h3>
        <span>vs. OMXS30 and S&P500 · indexed to inception · SEK</span>
      </div>
      <div class="button-container">
        <button onclick="setTimeRange('1m', this)">1M</button>
        <button onclick="setTimeRange('3m', this)">3M</button>
        <button onclick="setTimeRange('1y', this)">1Y</button>
        <button onclick="setTimeRange('ytd', this)">YTD</button>
        <button onclick="setTimeRange('all', this)" class="active">All</button>
      </div>
    </div>
    <div class="chart-container">
      <canvas id="valueChart"></canvas>
    </div>
    <div class="chart-legend">
      <div class="legend-item">
        <div class="legend-line" style="background: #B8974A;"></div>
        Portfolio
      </div>
      <div class="legend-item">
        <div class="legend-line" style="background: rgba(168,196,176,0.6); border-top: 1px dashed rgba(168,196,176,0.5); height:0; margin-top:1px;"></div>
        OMXS30
      </div>
      <div class="legend-item">
        <div class="legend-line" style="background: transparent; border-top: 1px dashed rgba(122,126,116,0.4); height:0; margin-top:1px;"></div>
        S&P500
      </div>
    </div>
  </div>

  <!-- Three-column info -->
  <div class="info-sections">

    <!-- Current Holdings -->
    <div class="info-column">
      <div class="col-header">
        <span class="col-number">i.</span>
        <h3>Current Holdings</h3>
      </div>
      {% for item in current %}
      <div class="holding-item">
        <span class="h-name">{{ item }}</span>
        <span class="h-dot"></span>
      </div>
      {% endfor %}
    </div>

    <!-- Prior Positions -->
    <div class="info-column">
      <div class="col-header">
        <span class="col-number">ii.</span>
        <h3>Prior Positions</h3>
      </div>
      {% for item in past[:7] %}
      <div class="past-item">{{ item }}</div>
      {% endfor %}

      <div class="past-overflow" id="past-overflow">
        {% for item in past[7:] %}
        <div class="past-item">{{ item }}</div>
        {% endfor %}
      </div>

      <button class="past-toggle" onclick="togglePast()">
        <span id="past-toggle-label">Show all</span>
        <span class="past-chevron" id="past-chevron">▾</span>
      </button>
    </div>

    <!-- Bylaws -->
    <div class="info-column">
      <div class="col-header">
        <span class="col-number">iii.</span>
        <h3>Articles of Association</h3>
      </div>
      <div class="bylaws-body">
        <div class="bylaws-doc-row">
          <svg width="24" height="32" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0; opacity:0.7;">
            <rect x="0.5" y="0.5" width="23" height="31" rx="1.5" fill="var(--surface-2)" stroke="var(--border)"/>
            <path d="M14 0.5V7H22" stroke="var(--border)"/>
            <line x1="4" y1="12" x2="20" y2="12" stroke="var(--gold-dim)" stroke-width="1" stroke-linecap="round"/>
            <line x1="4" y1="16" x2="20" y2="16" stroke="var(--gold-dim)" stroke-width="1" stroke-linecap="round"/>
            <line x1="4" y1="20" x2="20" y2="20" stroke="var(--gold-dim)" stroke-width="1" stroke-linecap="round"/>
            <line x1="4" y1="24" x2="13" y2="24" stroke="var(--gold-dim)" stroke-width="1" stroke-linecap="round"/>
          </svg>
          <div class="bylaws-doc-info">
            <span class="bylaws-filename">Bylaws.pdf</span>
            <span class="bylaws-filetype">Governing Document</span>
          </div>
          <span class="bylaws-badge">PDF</span>
        </div>
        <p class="bylaws-description">
          The Articles of Association govern the investment mandate, decision-making framework, and all formal provisions of Figab Capital Partners.
        </p>
        <a class="bylaws-open-btn" href="/reports/Bylaws.pdf" target="_blank" rel="noopener">
          <svg width="11" height="11" viewBox="0 0 11 11" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round">
            <path d="M5.5 1v7M5.5 8L3 5.5M5.5 8L8 5.5"/>
            <path d="M1 10h9"/>
          </svg>
          Open Document
        </a>
      </div>
    </div>

  </div><!-- /info-sections -->

</div><!-- /performance -->

<!-- ══════════════════════════════════════
     FOOTER
══════════════════════════════════════ -->
<footer>
  <div class="footer-inner">
    <span class="footer-brand">Figab Capital Partners</span>
    <div class="footer-contact">
      <span class="footer-contact-label">Contact</span>
      <a>kontakt@figab.se</a>
    </div>
    <span class="footer-meta"> Est. 2025</span>
  </div>
</footer>


<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
/* Palette */

const portfolioColor = '#B8974A';
const omxColor       = isDark ? 'rgba(35,72,192,0.5)' : 'rgba(35,72,192,0.5)';
const gspcColor      = isDark ? 'rgba(202,15,15,0.5)'  : 'rgba(202,15,15,0.5)';
const gridColor      = isDark ? 'rgba(31,52,38,0.8)'     : 'rgba(221,216,204,0.8)';
const textColor      = isDark ? '#4A6054'                 : '#7A7E74';
const tooltipBg      = isDark ? '#111F16'                 : '#FDFAF5';
const tooltipBorder  = isDark ? '#1F3426'                 : '#DDD8CC';
const tooltipTitle   = isDark ? '#D4B06A'                 : '#B8974A';
const tooltipBody    = isDark ? '#A8B5A0'                 : '#3C4038';

const fullLabels = {{ line_labels | tojson }};
const fullData   = {{ line_data   | tojson }};
const omxFull    = {{ omx_data    | tojson }};
const gspcFull   = {{ gspc_data   | tojson }};

const ctx = document.getElementById('valueChart').getContext('2d');

function makeGradient() {
  const h = ctx.canvas.clientHeight || 320;
  const grad = ctx.createLinearGradient(0, 0, 0, h);
  if (isDark) {
    grad.addColorStop(0, 'rgba(184,151,74,0.14)');
    grad.addColorStop(1, 'rgba(184,151,74,0.0)');
  } else {
    grad.addColorStop(0, 'rgba(184,151,74,0.1)');
    grad.addColorStop(1, 'rgba(184,151,74,0.0)');
  }
  return grad;
}

const valueChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: fullLabels,
    datasets: [
      {
        label: 'Portfolio',
        data: fullData,
        borderColor: portfolioColor,
        backgroundColor: makeGradient(),
        fill: true,
        borderWidth: 2,
        pointRadius: 0,
        pointHoverRadius: 4,
        pointHoverBackgroundColor: portfolioColor,
        tension: 0.25
      },
      {
        label: 'OMXS30',
        data: omxFull,
        borderColor: omxColor,
        borderDash: [4, 5],
        fill: false,
        pointRadius: 0,
        borderWidth: 1.8,
        tension: 0.25
      },
      {
        label: 'S&P500',
        data: gspcFull,
        borderColor: gspcColor,
        borderDash: [4, 5],
        fill: false,
        pointRadius: 0,
        borderWidth: 1.8,
        tension: 0.25
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    events: ['mousemove', 'mouseout', 'click', 'touchstart', 'touchmove'],   
    interaction: { mode: 'index', intersect: false },
    plugins: {
      legend: { display: true },
      tooltip: {
        backgroundColor: tooltipBg,
        borderColor: tooltipBorder,
        borderWidth: 1,
        titleColor: tooltipTitle,
        bodyColor: tooltipBody,
        titleFont: { family: 'EB Garamond, Georgia, serif', size: 12, weight: '400' },
        bodyFont:  { family: 'EB Garamond, Georgia, serif', size: 12 },
        padding: 14,
        callbacks: {
          label: c =>
            ` ${c.dataset.label}  ${Math.round(c.parsed.y).toLocaleString('sv-SE')} SEK`
        }
      }
    },
    scales: {
      x: {
        grid: { color: gridColor, borderColor: 'transparent' },
        ticks: {
          color: textColor,
          font: { family: 'EB Garamond, Georgia, serif', size: 11 },
          maxRotation: window.innerWidth <= 600 ? 35 : 30,
          minRotation: window.innerWidth <= 600 ? 35 : 30,
          autoSkip: true,
          maxTicksLimit: 10,
          includeBounds: true,
          callback: function(value) {
            const label = this.chart.data.labels[value];
            if (!label) return '';
            if (window.innerWidth <= 600) {
              const d = new Date(label);
              return d.toLocaleDateString('en-GB', { month: 'short', year: '2-digit' });
            }
            return label;
          }
        }
      },
      y: {
        position: 'right',
        grid: { color: gridColor, borderColor: 'transparent' },
        ticks: {
          color: textColor,
          font: { family: 'EB Garamond, Georgia, serif', size: 11 },
          callback: v => Math.round(v).toLocaleString('sv-SE')
        }
      }
    }
  }
});



/* Time range */
function setTimeRange(range, btn) {
  document.querySelectorAll('.button-container button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');

  const now = new Date();
  let from;
  if      (range === '1m')  from = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
  else if (range === '3m')  from = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
  else if (range === '1y')  from = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
  else if (range === 'ytd') from = new Date(now.getFullYear(), 0, 1);
  else                      from = new Date('1970-01-01');

  const fl=[], fp=[], fo=[], fg=[];
  fullLabels.forEach((l, i) => {
    if (new Date(l) >= from) { fl.push(l); fp.push(fullData[i]); fo.push(omxFull[i]); fg.push(gspcFull[i]); }
  });

  if (!fp.length) return;

  const base = fp[0];
  const rebasedOMX  = fo.map(v => v * (base / fo[0]));
  const rebasedGSPC = fg.map(v => v * (base / fg[0]));

  const combined = [...fp, ...rebasedOMX, ...rebasedGSPC];
  const minY = Math.min(...combined), maxY = Math.max(...combined);
  const pad  = (maxY - minY) * 0.06;

  valueChart.options.scales.y.min = Math.floor((minY - pad) / 1000) * 1000;
  valueChart.options.scales.y.max = Math.ceil((maxY + pad) / 1000) * 1000;
  valueChart.data.labels = fl;
  valueChart.data.datasets[0].data = fp;
  valueChart.data.datasets[1].data = rebasedOMX;
  valueChart.data.datasets[2].data = rebasedGSPC;
  valueChart.update();
}

/* Prior positions toggle */
function togglePast() {
  const overflow = document.getElementById('past-overflow');
  const chevron  = document.getElementById('past-chevron');
  const label    = document.getElementById('past-toggle-label');
  const isOpen   = overflow.classList.toggle('open');
  chevron.classList.toggle('rotated', isOpen);
  label.textContent = isOpen ? 'Show less' : 'Show all';
}
</script>
</body>
</html>
