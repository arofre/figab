
{% extends "base.html" %}

{% block title %}Figab Capital Partners — Reports{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/report.css') }}" />
{% endblock %}

{% block page_title_bar %}
<div class="page-title-bar">
  <div class="page-title-inner">
    <div class="page-title-cell">
      <span class="page-eyebrow">Archive</span>
      <h1>Reports & Documents</h1>
    </div>
    <span class="page-count">
      {% set total = namespace(n=0) %}
      {% for folder in report_folders + (['Other'] if 'Other' in reports_data else []) %}
        {% if folder in reports_data %}
          {% set total.n = total.n + reports_data[folder] | length %}
        {% endif %}
      {% endfor %}
      {{ total.n }} document{{ 's' if total.n != 1 else '' }}
    </span>
  </div>
</div>
{% endblock %}

{% block body %}
<main>

  {% set folder_order = report_folders + (['Other'] if 'Other' in reports_data else []) %}
  {% set ns = namespace(folder_idx=0) %}

  {% for folder in folder_order %}
    {% if folder in reports_data %}
    {% set ns.folder_idx = ns.folder_idx + 1 %}
    <section class="report-folder">

      <div class="folder-header" onclick="toggleFolder(this)">
        <span class="folder-num">{{ '%02d' % ns.folder_idx }}</span>
        <div class="folder-title-area">
          <h3>{{ folder }}</h3>
          {% if reports_data[folder] %}
          <span class="folder-doc-count">{{ reports_data[folder] | length }} document{{ 's' if reports_data[folder] | length != 1 else '' }}</span>
          {% endif %}
        </div>
        <div class="folder-arrow-cell">
          <span class="folder-arrow">▶</span>
        </div>
      </div>

      <div class="folder-content {% if loop.index == 1 %}open{% endif %}">
        {% if reports_data[folder] %}
        <ul class="report-list">
          {% for filename in reports_data[folder] %}
          <li>
            <a href="/reports/{{ folder | urlencode }}/{{ filename }}" target="_blank">
              <span class="report-index">{{ '%02d' % loop.index }}</span>
              <span class="report-name">{{ filename | replace('_', ' ') | replace('-', ' – ') }}</span>
              <span class="report-ext {{ filename.split('.')[-1].lower() }}">{{ filename.split('.')[-1].upper() }}</span>
            </a>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="empty-folder">No documents in this folder yet.</p>
        {% endif %}
      </div>

    </section>
    {% endif %}
  {% endfor %}

</main>
{% endblock %}

{% block footer_meta %}Est. 2025{% endblock %}

{% block body_scripts %}
<script>
function toggleFolder(header) {
  header.classList.toggle('active');
  header.nextElementSibling.classList.toggle('open');
}

document.addEventListener('DOMContentLoaded', () => {
  const first = document.querySelector('.folder-header');
  if (first) first.classList.add('active');
});
</script>
{% endblock %}
